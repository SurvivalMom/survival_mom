<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¯¾è©±ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ100ã€ä½“é¨“ç‰ˆã€‘</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;800;900&family=Zen+Kaku+Gothic+New:wght@400;700;900&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Zen Kaku Gothic New','Nunito', sans-serif; min-height: 100vh; background: #f8fafc; }

    /* â”€â”€ ä½“é¨“ç‰ˆãƒãƒŠãƒ¼ â”€â”€ */
    .taiken-banner {
      background: linear-gradient(90deg,#faf5ff,#ede9fe);
      border-bottom: 2px solid #a78bfa;
      padding: 9px 16px; text-align: center;
      font-size: 12px; font-weight: 800; color: #4c1d95; letter-spacing: 0.04em;
    }
    .taiken-banner strong { color: #7c3aed; }

    /* â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€ */
    .hd { background: linear-gradient(135deg,#7c3aed,#a78bfa); padding: 22px 16px 28px; color: #fff; }
    .hd-inner { max-width: 640px; margin: 0 auto; }
    .hd-eyebrow { font-size: 12px; color: #ddd6fe; font-weight: 700; letter-spacing: 1px; margin-bottom: 4px; }
    .hd-title { font-size: 22px; font-weight: 900; }
    .hd-desc  { font-size: 13px; color: #ede9fe; margin-top: 5px; }

    /* çµ±è¨ˆãƒãƒ¼ */
    .stats-row {
      display: flex; gap: 12px; margin-top: 16px; flex-wrap: wrap;
    }
    .stat-chip {
      background: rgba(255,255,255,0.15); border-radius: 10px; padding: 7px 14px;
      text-align: center;
    }
    .stat-chip-num   { font-size: 17px; font-weight: 900; }
    .stat-chip-label { font-size: 10px; color: #ddd6fe; margin-top: 1px; }

    /* â”€â”€ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ â”€â”€ */
    .content { max-width: 640px; margin: 0 auto; padding: 18px 14px 120px; }

    /* â”€â”€ ãƒ©ãƒ³ãƒ€ãƒ ãƒœã‚¿ãƒ³ â”€â”€ */
    .random-btn {
      width: 100%; padding: 17px; border-radius: 18px; border: none;
      font-size: 15px; font-weight: 900; cursor: pointer; font-family: inherit;
      background: linear-gradient(135deg,#7c3aed,#a78bfa); color: #fff;
      box-shadow: 0 6px 24px rgba(124,58,237,0.4); margin-bottom: 20px;
      display: flex; align-items: center; justify-content: center; gap: 10px;
      letter-spacing: 0.03em; transition: all 0.15s;
    }
    .random-btn:hover { filter: brightness(1.08); transform: scale(1.02); }
    .random-btn:active { transform: scale(0.98); }

    /* â”€â”€ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ â”€â”€ */
    .filter-scroll {
      display: flex; gap: 8px; overflow-x: auto; padding-bottom: 8px; margin-bottom: 14px;
      scrollbar-width: none; -ms-overflow-style: none;
    }
    .filter-scroll::-webkit-scrollbar { display: none; }
    .filter-chip {
      padding: 8px 14px; border-radius: 99px; font-size: 12px; font-weight: 800;
      border: none; background: #f1f5f9; color: #64748b; cursor: pointer;
      font-family: inherit; white-space: nowrap; flex-shrink: 0; transition: all 0.15s;
    }
    .filter-chip.active { color: #fff; }
    .filter-chip:hover { filter: brightness(0.95); }

    /* â”€â”€ ãƒ­ãƒƒã‚¯æ®‹æ•°ãƒãƒŠãƒ¼ â”€â”€ */
    .locked-count-banner {
      background: linear-gradient(135deg,#faf5ff,#ede9fe);
      border: 1.5px solid #c4b5fd; border-radius: 14px;
      padding: 13px 16px; text-align: center; margin-bottom: 16px;
      font-size: 13px; color: #4c1d95; font-weight: 700; line-height: 1.85;
    }
    .locked-count-banner strong { color: #7c3aed; font-size: 14px; }

    /* â”€â”€ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚«ãƒ¼ãƒ‰ â”€â”€ */
    .prompt-list { display: flex; flex-direction: column; gap: 12px; margin-bottom: 20px; }

    .prompt-card {
      background: #fff; border-radius: 18px; padding: 16px 18px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      cursor: pointer; transition: all 0.18s cubic-bezier(.4,2,.6,1);
    }
    .prompt-card:hover { transform: translateY(-3px); box-shadow: 0 10px 24px rgba(0,0,0,0.1); }
    .prompt-card.used { opacity: 0.6; }

    .prompt-card.locked {
      background: #f8fafc; cursor: default; opacity: 0.5; filter: grayscale(0.2);
    }
    .prompt-card.locked:hover { transform: none; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }

    .p-tags { display: flex; gap: 6px; margin-bottom: 8px; flex-wrap: wrap; align-items: center; }
    .p-tag {
      font-size: 11px; font-weight: 800; padding: 2px 8px; border-radius: 99px;
    }
    .p-used-tag { font-size: 11px; font-weight: 800; background: #f0fdf4; color: #16a34a; padding: 2px 8px; border-radius: 99px; }
    .p-ng { font-size: 11px; color: #ef4444; font-weight: 800; margin-bottom: 4px; }
    .p-ng-txt { text-decoration: line-through; color: #94a3b8; }
    .p-ok { font-size: 15px; font-weight: 900; color: #1e293b; }
    .p-fav-btn { font-size: 22px; background: none; border: none; cursor: pointer; padding: 4px; transition: transform 0.2s cubic-bezier(.4,2,.6,1); flex-shrink: 0; }
    .p-fav-btn:hover { transform: scale(1.25); }

    /* ãƒ­ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰å†…å®¹ */
    .p-lock-content { display: flex; align-items: center; gap: 10px; }
    .p-lock-tag { font-size: 11px; font-weight: 800; padding: 2px 8px; border-radius: 99px; background: #f1f5f9; color: #94a3b8; }
    .p-lock-label { font-size: 14px; font-weight: 900; color: #cbd5e1; flex: 1; }
    .p-lock-badge { font-size: 11px; font-weight: 800; color: #94a3b8; background: #f1f5f9; border: 1px solid #e2e8f0; padding: 2px 10px; border-radius: 99px; }

    /* â”€â”€ ãƒ¢ãƒ¼ãƒ€ãƒ« â”€â”€ */
    .modal-bg {
      position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 99;
      display: flex; align-items: center; justify-content: center; padding: 20px;
    }
    .modal {
      background: #fff; border-radius: 28px; padding: 26px; max-width: 500px; width: 100%;
      animation: modalIn 0.3s cubic-bezier(.4,2,.6,1); max-height: 90vh; overflow-y: auto;
    }
    @keyframes modalIn { from{transform:scale(0.85);opacity:0} to{transform:scale(1);opacity:1} }
    .modal-tags { display: flex; gap: 8px; margin-bottom: 18px; flex-wrap: wrap; align-items: center; }
    .modal-ng { background: #fef2f2; border-radius: 14px; padding: 13px 16px; margin-bottom: 14px; }
    .modal-ng-lbl { font-size: 12px; color: #dc2626; font-weight: 800; margin-bottom: 5px; }
    .modal-ng-txt { font-size: 16px; font-weight: 800; color: #7f1d1d; text-decoration: line-through; }
    .modal-ok { border-radius: 14px; padding: 15px 18px; margin-bottom: 14px; border-width: 2px; border-style: solid; }
    .modal-ok-lbl { font-size: 12px; font-weight: 800; margin-bottom: 7px; }
    .modal-ok-txt { font-size: 21px; font-weight: 900; color: #14532d; line-height: 1.4; }
    .modal-tip { background: #faf5ff; border-radius: 12px; padding: 13px 15px; margin-bottom: 18px; }
    .modal-tip-lbl { font-size: 12px; color: #7c3aed; font-weight: 800; margin-bottom: 5px; }
    .modal-tip-txt { font-size: 14px; color: #4c1d95; line-height: 1.65; }
    .modal-close {
      width: 100%; padding: 14px; border-radius: 14px; border: none;
      font-size: 15px; font-weight: 900; cursor: pointer; font-family: inherit;
      background: linear-gradient(135deg,#7c3aed,#a78bfa); color: #fff;
      transition: all 0.15s;
    }
    .modal-close:hover { filter: brightness(1.08); }

    /* â”€â”€ CTA â”€â”€ */
    .cta-block {
      background: linear-gradient(135deg,#faf5ff,#ede9fe);
      border: 1.5px solid #c4b5fd; border-radius: 20px;
      padding: 22px 18px; text-align: center; margin-top: 8px;
    }
    .cta-eyebrow { font-size: 11px; font-weight: 900; letter-spacing: 0.15em; color: #7c3aed; text-transform: uppercase; margin-bottom: 8px; }
    .cta-text { font-size: 14px; font-weight: 800; color: #1e293b; line-height: 1.75; margin-bottom: 16px; }
    .cta-btn {
      display: inline-block; background: linear-gradient(135deg,#c8a97e,#d4b896);
      color: #fff; font-size: 14px; font-weight: 900; padding: 13px 26px;
      border-radius: 99px; text-decoration: none;
      box-shadow: 0 6px 20px rgba(200,169,126,0.4); font-family: inherit;
      transition: all 0.18s cubic-bezier(.34,1.4,.64,1);
    }
    .cta-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 28px rgba(200,169,126,0.5); }

    .hidden { display: none !important; }
  </style>
</head>
<body>

<div class="taiken-banner">
  âš ï¸ ã“ã‚Œã¯<strong>ä½“é¨“ç‰ˆ</strong>ã§ã™ã€€ï¼ã€€6æšã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç„¡æ–™ä½“é¨“ã§ãã¾ã™
</div>

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<div class="hd">
  <div class="hd-inner">
    <div class="hd-eyebrow">ã€ä½“é¨“ç‰ˆã€‘å¯¾è©±ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ100</div>
    <div class="hd-title">ğŸ’¬ é­”æ³•ã®ã“ã¨ã°</div>
    <div class="hd-desc">ã€Œå±ã‚‹ã€ã‚’ã€Œå•ã†ã€ã«å¤‰ãˆã‚‹è¨€è‘‰ã®ãƒ¬ã‚·ãƒ”</div>
    <div class="stats-row">
      <div class="stat-chip">
        <div class="stat-chip-num" id="stat-used">0</div>
        <div class="stat-chip-label">ã¤ã‹ã£ãŸ</div>
      </div>
      <div class="stat-chip">
        <div class="stat-chip-num" id="stat-fav">0</div>
        <div class="stat-chip-label">ãŠæ°—ã«å…¥ã‚Š</div>
      </div>
      <div class="stat-chip">
        <div class="stat-chip-num">6 / 30</div>
        <div class="stat-chip-label">ä½“é¨“ç‰ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</div>
      </div>
    </div>
  </div>
</div>

<div class="content">

  <!-- ãƒ©ãƒ³ãƒ€ãƒ ãƒœã‚¿ãƒ³ -->
  <button class="random-btn" onclick="pickRandom()">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ã«ã²ã¨ã¤ãˆã‚‰ã¶</button>

  <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
  <div class="filter-scroll" id="filter-row"></div>

  <!-- ãƒ­ãƒƒã‚¯æ®‹æ•° -->
  <div class="locked-count-banner">
    ğŸ”’ <strong>ã‚ã¨24ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</strong>ãŒè£½å“ç‰ˆã§è§£æ”¾ã•ã‚Œã¾ã™<br>
    å…¨6ã‚·ãƒ¼ãƒ³ Ã— 5æšï¼ˆå…¨30æšä¸­ï¼‰
  </div>

  <!-- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒªã‚¹ãƒˆ -->
  <div class="prompt-list" id="prompt-list"></div>

  <!-- CTA -->
  <div class="cta-block">
    <div class="cta-eyebrow">ï¼¼ ãƒ•ãƒ«æ©Ÿèƒ½ã¯ã“ã¡ã‚‰ ï¼</div>
    <div class="cta-text">
      å…¨30æšã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ»ãŠæ°—ã«å…¥ã‚Šä¿å­˜<br>
      ã‚·ãƒ¼ãƒ³åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»ãƒ©ãƒ³ãƒ€ãƒ æ©Ÿèƒ½<br>
      ã™ã¹ã¦ä½¿ã„æ”¾é¡Œ
    </div>
    <a class="cta-btn" href="https://buy.stripe.com/4gMwRc3k9GGFv46G373G04" target="_blank">å¯¾è©±ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ100ã‚’è³¼å…¥ã™ã‚‹ â†’</a>
  </div>
</div>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="modal-bg hidden" id="modal-bg" onclick="closeModal()">
  <div class="modal" id="modal" onclick="event.stopPropagation()"></div>
</div>

<script>
var PROMPTS_FREE = [
  { id:1,  situation:"morning",  tag:"ãã‚Šã‹ãˆ",   ng:"æ—©ãèµ·ããªã•ã„ï¼",         ok:"èµ·ããŸã‚‰ä½•ãŒã—ãŸã„ï¼Ÿ",             tip:"ã€Œã‚„ã‚ŠãŸã„ã“ã¨ã€ã§è‡ªç™ºçš„ã«å‹•ãã‚¹ã‚¤ãƒƒãƒã‚’å…¥ã‚Œã¾ã™ã€‚",         color:"#f59e0b" },
  { id:6,  situation:"homework", tag:"ã¨ã‚Šã‹ã‹ã‚Š", ng:"å®¿é¡Œã—ãªã•ã„ï¼",            ok:"ç­†ç®±ã‚’å‡ºã™ã ã‘ã‚„ã£ã¦ã¿ã‚ˆã†ã€‚",     tip:"æœ€åˆã®ä¸€æ­©ã‚’ã¨ã¦ã‚‚å°ã•ãã™ã‚‹ã®ãŒã‚³ãƒ„ã§ã™ã€‚",                 color:"#3b82f6" },
  { id:11, situation:"emotion",  tag:"ãŠã¡ã¤ã",   ng:"æ³£ã‹ãªã„ã®ï¼",              ok:"æ³£ããŸã„ã‚ˆã­ã€‚ã©ã†ã—ãŸã®ï¼Ÿ",       tip:"æ„Ÿæƒ…ã‚’å—ã‘æ­¢ã‚ã¦ã‹ã‚‰è©±ã—åˆã„ã«å…¥ã‚Šã¾ã™ã€‚",                   color:"#ef4444" },
  { id:16, situation:"meal",     tag:"ã—ã‚‡ãã˜",   ng:"æ®‹ã—ãŸã‚‰ãƒ€ãƒ¡ï¼",            ok:"ä¸€å£ã ã‘é£Ÿã¹ã¦ã¿ã‚ˆã†ã‹ã€‚ã©ã‚“ãªå‘³ãŒã™ã‚‹ï¼Ÿ", tip:"ã€Œä¸€å£ã€ã¨ã„ã†ãƒãƒ¼ãƒ‰ãƒ«ã‚’æœ€å°åŒ–ã—ã¾ã™ã€‚",                color:"#10b981" },
  { id:21, situation:"night",    tag:"ãã‚Šã‹ãˆ",   ng:"ãŠé¢¨å‘‚å…¥ã‚Šãªã•ã„ï¼",        ok:"ãŠé¢¨å‘‚ã€ä»Šæ—¥ã¯ä½•ã®ã‚·ãƒ£ãƒ³ãƒ—ãƒ¼ä½¿ã†ï¼Ÿ",tip:"ã€Œæ¥½ã—ã„è¦ç´ ã€ã§è‡ªç™ºçš„ã«å‹•ããã£ã‹ã‘ã‚’ä½œã‚Šã¾ã™ã€‚",         color:"#8b5cf6" },
  { id:26, situation:"school",   tag:"ã»ã†ã“ã",   ng:"å­¦æ ¡ã©ã†ã ã£ãŸï¼Ÿ(ã ã¾ã‚‹)",  ok:"ä»Šæ—¥ã€çµ¦é£Ÿã¯ä½•ã ã£ãŸï¼Ÿ",           tip:"å…·ä½“çš„ãªè³ªå•ãŒç­”ãˆã‚„ã™ã„å…¥å£ã«ãªã‚Šã¾ã™ã€‚",                   color:"#f97316" },
];

// ãƒ­ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰ï¼ˆå­˜åœ¨ã ã‘ç¤ºã™ï¼‰
var PROMPTS_LOCKED = [
  { id:2,  situation:"morning",  tag:"ã—ãŸã",     color:"#f59e0b" },
  { id:3,  situation:"morning",  tag:"ã—ãŸã",     color:"#f59e0b" },
  { id:4,  situation:"morning",  tag:"ã‚‚ã¡ã‚‚ã®",   color:"#f59e0b" },
  { id:5,  situation:"morning",  tag:"ãã‚Šã‹ãˆ",   color:"#f59e0b" },
  { id:7,  situation:"homework", tag:"ã—ã‚…ã†ã¡ã‚…ã†",color:"#3b82f6" },
  { id:8,  situation:"homework", tag:"ã‚‚ã¨ã‚ã‚‹",   color:"#3b82f6" },
  { id:9,  situation:"homework", tag:"ã»ã‚ã‚‹",     color:"#3b82f6" },
  { id:10, situation:"homework", tag:"ã¨ã‚Šã‹ã‹ã‚Š", color:"#3b82f6" },
  { id:12, situation:"emotion",  tag:"ãã‚‚ã¡ã‚’ãã",color:"#ef4444" },
  { id:13, situation:"emotion",  tag:"ã‘ã‚“ã‹",     color:"#ef4444" },
  { id:14, situation:"emotion",  tag:"ã“ã†ã‹ã‚“",   color:"#ef4444" },
  { id:15, situation:"emotion",  tag:"ãŠã¡ã¤ã",   color:"#ef4444" },
  { id:17, situation:"meal",     tag:"ã—ã‚‡ãã˜",   color:"#10b981" },
  { id:18, situation:"meal",     tag:"ãªãŒãŸã¹",   color:"#10b981" },
  { id:19, situation:"meal",     tag:"ã—ã‚‡ãã˜",   color:"#10b981" },
  { id:20, situation:"meal",     tag:"ã»ã‚ã‚‹",     color:"#10b981" },
  { id:22, situation:"night",    tag:"ã­ã‚‹",       color:"#8b5cf6" },
  { id:23, situation:"night",    tag:"ãã‚Šã‹ãˆ",   color:"#8b5cf6" },
  { id:24, situation:"night",    tag:"ãµã‚Šã‹ãˆã‚Š", color:"#8b5cf6" },
  { id:25, situation:"night",    tag:"ã­ã‚‹",       color:"#8b5cf6" },
  { id:27, situation:"school",   tag:"ã¨ã‚‚ã ã¡",   color:"#f97316" },
  { id:28, situation:"school",   tag:"ã‚‚ã‚“ã ã„",   color:"#f97316" },
  { id:29, situation:"school",   tag:"ã¯ã’ã¾ã™",   color:"#f97316" },
  { id:30, situation:"school",   tag:"ã»ã†ã“ã",   color:"#f97316" },
];

var SITUATIONS = [
  { id:"all",      label:"ã™ã¹ã¦",     icon:"ğŸ“‹", color:"#64748b" },
  { id:"morning",  label:"ã‚ã•",       icon:"ğŸŒ…", color:"#f59e0b" },
  { id:"homework", label:"ã—ã‚…ãã ã„", icon:"ğŸ“", color:"#3b82f6" },
  { id:"emotion",  label:"ãã‚‚ã¡",     icon:"ğŸ’", color:"#ef4444" },
  { id:"meal",     label:"ã”ã¯ã‚“",     icon:"ğŸš", color:"#10b981" },
  { id:"night",    label:"ã‚ˆã‚‹",       icon:"ğŸŒ™", color:"#8b5cf6" },
  { id:"school",   label:"ãŒã£ã“ã†",   icon:"ğŸ«", color:"#f97316" },
];

var curFilter = "all";
var favorites = [];
var used      = [];
var curModal  = null;

init();

function init() {
  renderFilters();
  renderList();
}

function renderFilters() {
  var row = document.getElementById("filter-row");
  row.innerHTML = "";
  SITUATIONS.forEach(function(s){
    var btn = document.createElement("button");
    btn.className = "filter-chip" + (curFilter === s.id ? " active" : "");
    btn.textContent = s.icon + " " + s.label;
    if (curFilter === s.id) btn.style.background = s.color;
    btn.addEventListener("click", function(){
      curFilter = s.id;
      renderFilters();
      renderList();
    });
    row.appendChild(btn);
  });
}

function renderList() {
  var list = document.getElementById("prompt-list");
  list.innerHTML = "";

  var freeFiltered   = curFilter === "all" ? PROMPTS_FREE   : PROMPTS_FREE.filter(function(p){ return p.situation === curFilter; });
  var lockedFiltered = curFilter === "all" ? PROMPTS_LOCKED : PROMPTS_LOCKED.filter(function(p){ return p.situation === curFilter; });
  var sit = getSit(curFilter);

  // ä½¿ãˆã‚‹ã‚«ãƒ¼ãƒ‰
  freeFiltered.forEach(function(p){
    var div = document.createElement("div");
    var isUsed = used.indexOf(p.id) !== -1;
    var isFav  = favorites.indexOf(p.id) !== -1;
    div.className = "prompt-card" + (isUsed ? " used" : "");
    div.style.borderLeft = "4px solid " + p.color;

    var sitObj = getSit(p.situation);
    div.innerHTML =
      '<div style="display:flex;align-items:flex-start;gap:10px">'+
        '<div style="flex:1">'+
          '<div class="p-tags">'+
            '<span class="p-tag" style="background:'+p.color+'15;color:'+p.color+'">'+sitObj.icon+' '+sitObj.label+'</span>'+
            '<span class="p-tag" style="background:#f1f5f9;color:#64748b">#'+p.tag+'</span>'+
            (isUsed ? '<span class="p-used-tag">âœ… ã¤ã‹ã£ãŸ</span>' : '')+
          '</div>'+
          '<div class="p-ng">ğŸš« ã‚ˆãã‚ã‚‹è¨€ã„æ–¹ï¼š<span class="p-ng-txt">'+p.ng+'</span></div>'+
          '<div class="p-ok">ğŸ’¬ ã€Œ'+p.ok+'ã€</div>'+
        '</div>'+
        '<button class="p-fav-btn" onclick="event.stopPropagation();toggleFav('+p.id+')">'+(isFav?"â¤ï¸":"ğŸ¤")+'</button>'+
      '</div>';
    div.addEventListener("click", function(){ openModal(p); });
    list.appendChild(div);
  });

  // ãƒ­ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰
  lockedFiltered.forEach(function(p){
    var div = document.createElement("div");
    div.className = "prompt-card locked";
    div.style.borderLeft = "4px solid " + p.color + "55";
    var sitObj = getSit(p.situation);
    div.innerHTML =
      '<div class="p-lock-content">'+
        '<span class="p-lock-tag" style="background:'+p.color+'10;color:'+p.color+'80">'+sitObj.icon+' '+sitObj.label+'</span>'+
        '<span class="p-lock-tag">#'+p.tag+'</span>'+
        '<span style="flex:1;font-size:14px;color:#cbd5e1;font-weight:900">ğŸ’¬ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span>'+
        '<span class="p-lock-badge">ğŸ”’ è£½å“ç‰ˆ</span>'+
      '</div>';
    list.appendChild(div);
  });

  // çµ±è¨ˆæ›´æ–°
  document.getElementById("stat-used").textContent = used.length;
  document.getElementById("stat-fav").textContent  = favorites.length;
}

function getSit(id) {
  return SITUATIONS.find(function(s){ return s.id === id; }) || SITUATIONS[0];
}

function toggleFav(id) {
  var idx = favorites.indexOf(id);
  if (idx !== -1) favorites.splice(idx, 1);
  else favorites.push(id);
  renderList();
  if (curModal && curModal.id === id) openModal(curModal); // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚‚æ›´æ–°
}

function markUsed(id) {
  if (used.indexOf(id) === -1) used.push(id);
}

function openModal(p) {
  curModal = p;
  markUsed(p.id);
  var isFav = favorites.indexOf(p.id) !== -1;
  var sitObj = getSit(p.situation);
  var modal = document.getElementById("modal");
  modal.innerHTML =
    '<div class="modal-tags">'+
      '<span class="p-tag" style="background:'+p.color+'15;color:'+p.color+';font-size:12px;padding:4px 12px;border-radius:99px">'+sitObj.icon+' '+sitObj.label+'</span>'+
      '<span class="p-tag" style="background:#f1f5f9;color:#64748b;font-size:12px;padding:4px 12px;border-radius:99px">#'+p.tag+'</span>'+
      '<button class="p-fav-btn" onclick="toggleFav('+p.id+')" style="margin-left:auto;font-size:24px">'+(isFav?"â¤ï¸":"ğŸ¤")+'</button>'+
    '</div>'+
    '<div class="modal-ng">'+
      '<div class="modal-ng-lbl">ğŸš« ã‚ˆãã‚ã‚‹è¨€ã„æ–¹</div>'+
      '<div class="modal-ng-txt">ã€Œ'+p.ng+'ã€</div>'+
    '</div>'+
    '<div class="modal-ok" style="background:#f0fdf4;border-color:'+p.color+'44">'+
      '<div class="modal-ok-lbl" style="color:#16a34a">âœ¨ ã‹ã‚ã‚Šã®ã“ã¨ã°</div>'+
      '<div class="modal-ok-txt">ã€Œ'+p.ok+'ã€</div>'+
    '</div>'+
    '<div class="modal-tip">'+
      '<div class="modal-tip-lbl">ğŸ’¡ ãªãœåŠ¹ãã®ã‹</div>'+
      '<div class="modal-tip-txt">'+p.tip+'</div>'+
    '</div>'+
    '<button class="modal-close" onclick="closeModal()">âœ• ã¨ã˜ã‚‹</button>';

  document.getElementById("modal-bg").classList.remove("hidden");
  renderList();
}

function closeModal() {
  curModal = null;
  document.getElementById("modal-bg").classList.add("hidden");
}

function pickRandom() {
  var pool = PROMPTS_FREE.filter(function(p){
    return (curFilter === "all" || p.situation === curFilter) && used.indexOf(p.id) === -1;
  });
  if (!pool.length) pool = PROMPTS_FREE.filter(function(p){
    return curFilter === "all" || p.situation === curFilter;
  });
  if (!pool.length) return;
  var pick = pool[Math.floor(Math.random() * pool.length)];
  openModal(pick);
}
</script>
</body>
</html>
