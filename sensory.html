<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ„Ÿè¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¦³å¯Ÿãƒãƒ¼ãƒˆ</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;800;900&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Nunito', sans-serif; min-height: 100vh; background: #f8fafc; }
    .card      { transition: all 0.18s cubic-bezier(.4,2,.6,1); cursor: pointer; }
    .card:hover { transform: translateY(-3px); box-shadow: 0 10px 24px rgba(0,0,0,0.1); }
    .btn       { border: none; cursor: pointer; font-family: 'Nunito', sans-serif; transition: all 0.15s; }
    .btn:hover  { filter: brightness(1.07); transform: scale(1.02); }
    .btn:active { transform: scale(0.97); }
    .freq-btn  { transition: all 0.15s; cursor: pointer; border: none; font-family: 'Nunito', sans-serif; }
    .freq-btn:hover { transform: scale(1.05); }
    .bar { transition: width 0.8s cubic-bezier(.4,0,.2,1); }
    textarea, input { font-family: 'Nunito', sans-serif; }
  
    .home-btn {
      position: fixed; bottom: 20px; right: 20px; z-index: 9999;
      background: rgba(15,14,23,0.88); backdrop-filter: blur(8px);
      color: #fff; border: 1px solid rgba(255,255,255,0.15);
      border-radius: 99px; padding: 10px 20px;
      font-family: "Nunito", sans-serif; font-size: 13px; font-weight: 800;
      text-decoration: none; display: flex; align-items: center; gap: 6px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: all 0.2s cubic-bezier(.4,2,.3,1);
    }
    .home-btn:hover { transform: scale(1.08); background: rgba(255,137,6,0.92); border-color: transparent; }
</style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const SENSORY_CATEGORIES = [
      { id:"visual",         icon:"ğŸ‘ï¸", label:"è¦–è¦š",     color:"#3b82f6", light:"#eff6ff",
        items:[{id:"v1",label:"ã¾ã¶ã—ã„ã²ã‹ã‚Šã‚’ã„ã‚„ãŒã‚‹"},{id:"v2",label:"ã†ã”ãã‚‚ã®ã«ã™ããã‚’ã¨ã‚‰ã‚Œã‚‹"},{id:"v3",label:"ã”ã¡ã‚ƒã”ã¡ã‚ƒã—ãŸã°ã—ã‚‡ãŒã«ãŒã¦"},{id:"v4",label:"ç´°ã‹ã„ã‚‚ã®ã‚’ã˜ã£ã¨ã¿ã¤ã‚ã‚‹"},{id:"v5",label:"ãã‚‰ã„ã°ã—ã‚‡ã‚’ã“ã‚ãŒã‚‹"}]},
      { id:"audio",          icon:"ğŸ‘‚", label:"è´è¦š",     color:"#8b5cf6", light:"#f5f3ff",
        items:[{id:"a1",label:"ãŠãŠããªãŠã¨ã«ã³ã£ãã‚Šã™ã‚‹"},{id:"a2",label:"ã•ã‚ãŒã—ã„ã°ã—ã‚‡ã§ãƒ‘ãƒ‹ãƒƒã‚¯ã«ãªã‚‹"},{id:"a3",label:"ã¨ãã¦ã„ã®ãŠã¨ã‚’ã¨ã¦ã‚‚ãã‚‰ã†"},{id:"a4",label:"ã“ãˆã‹ã‘ã«ãã¥ã‹ãªã„ã“ã¨ãŒã‚ã‚‹"},{id:"a5",label:"ã˜ã¶ã‚“ã®ã“ãˆãŒãŠãŠãã™ãã‚‹"}]},
      { id:"touch",          icon:"ğŸ¤²", label:"è§¦è¦š",     color:"#f59e0b", light:"#fffbeb",
        items:[{id:"t1",label:"ãµãã®ã‚¿ã‚°ã‚„ã‚½ãƒƒã‚¯ã‚¹ã‚’ã„ã‚„ãŒã‚‹"},{id:"t2",label:"ã‹ã¿ã®ã‘ã‚’ã¨ã‹ã•ã‚Œã‚‹ã®ã‚’ã„ã‚„ãŒã‚‹"},{id:"t3",label:"ã­ã‚“ã©ã‚„çµµã®å…·ã‚’ã•ã‚ã‚ŠãŸãŒã‚‰ãªã„"},{id:"t4",label:"ã„ãŸã¿ã«ãã¥ãã«ãã„"},{id:"t5",label:"ã‚‚ã®ã‚’ã•ã‚ã‚Šç¶šã‘ã‚‹"}]},
      { id:"vestibular",     icon:"ğŸŒ€", label:"å‰åº­è¦š",   color:"#10b981", light:"#ecfdf5",
        items:[{id:"ve1",label:"ãƒ–ãƒ©ãƒ³ã‚³ã‚„ã™ã¹ã‚Šã ã„ã‚’ã“ã‚ãŒã‚‹"},{id:"ve2",label:"ãã‚‹ãã‚‹ã¾ã‚ã‚‹ã“ã¨ãŒã ã„ã™ã"},{id:"ve3",label:"ãŸã‹ã„ã¨ã“ã‚ã«ã®ã¼ã‚ŠãŸãŒã‚‹"},{id:"ve4",label:"ã˜ã£ã¨ã—ã¦ã„ã‚‰ã‚Œãªã„"},{id:"ve5",label:"ã®ã‚Šã‚‚ã®ã§ã‚ˆã„ã‚„ã™ã„"}]},
      { id:"proprioception", icon:"ğŸ’ª", label:"å›ºæœ‰å—å®¹è¦š", color:"#ef4444", light:"#fef2f2",
        items:[{id:"p1",label:"ã‚‚ã®ã‚’ã‚ˆããŠã¨ã™ãƒ»ã“ã¼ã™"},{id:"p2",label:"ã¡ã‹ã‚‰ã‹ã’ã‚“ãŒã‚€ãšã‹ã—ã„"},{id:"p3",label:"ã‹ã¹ã‚„ã¯ã—ã‚‰ã«ã‚ˆã‚Šã‹ã‹ã‚‹"},{id:"p4",label:"ã‚‚ã®ã‚’ã¤ã‚ˆãã«ãã‚Šã™ãã‚‹"},{id:"p5",label:"ã‹ã‚‰ã ãŒã¤ã‹ã‚Œã‚„ã™ã„"}]},
      { id:"oral",           icon:"ğŸ‘„", label:"å£è…”æ„Ÿè¦š", color:"#f97316", light:"#fff7ed",
        items:[{id:"o1",label:"ã¨ãã¦ã„ã®ãŸã¹ã‚‚ã®ã®ã‹ãŸã¡ãŒã«ãŒã¦"},{id:"o2",label:"ã‚‚ã®ã‚’ã‚ˆãã‹ã˜ã‚‹ãƒ»ãªã‚ã‚‹"},{id:"o3",label:"ã‹ã‚‰ã„ã‚‚ã®ãƒ»ã™ã£ã±ã„ã‚‚ã®ãŒã ã„ã™ã"},{id:"o4",label:"ã¯ã¿ãŒãã‚’ã¨ã¦ã‚‚ã„ã‚„ãŒã‚‹"},{id:"o5",label:"ã»ãŠã°ã‚Šã™ãã‚‹"}]},
    ];

    const FREQ = [
      { value:0, label:"ã»ã¼ãªã„",  color:"#94a3b8" },
      { value:1, label:"ã¨ãã©ã",  color:"#fbbf24" },
      { value:2, label:"ã‚ˆãã‚ã‚‹",  color:"#f97316" },
      { value:3, label:"ã»ã¼ã„ã¤ã‚‚", color:"#ef4444" },
    ];

    const SITUATIONS   = ["ã‚ã•","ã²ã‚‹ã¾","ã‚ˆã‚‹","ãŒã£ã“ã†","ãã¨","ãŠã†ã¡"];
    const MEMO_PROMPTS = ["ã©ã‚“ãªã¨ãï¼Ÿã©ã“ã§ï¼Ÿ","ã¾ãˆã¶ã‚Œã¯ã‚ã£ãŸï¼Ÿ","ã©ã®ãã‚‰ã„ã¤ã¥ã„ãŸï¼Ÿ","ã©ã†ã—ãŸã‚‰ãŠã¡ã¤ã„ãŸï¼Ÿ"];
    const MOODS        = ["ğŸ˜¢","ğŸ˜•","ğŸ˜","ğŸ˜Š","ğŸ˜„"];

    function SensoryProfile() {
      const [screen, setScreen]           = useState("home");
      const [ratings, setRatings]         = useState(() => { try { return JSON.parse(localStorage.getItem("tdl_sp_ratings")||"{}"); } catch { return {}; } });
      const [diary, setDiary]             = useState(() => { try { return JSON.parse(localStorage.getItem("tdl_sp_diary")||"[]"); } catch { return []; } });
      const [addingEntry, setAddingEntry] = useState(false);
      const [expandedCat, setExpandedCat] = useState(null);
      const [newEntry, setNewEntry]       = useState({ date:new Date().toLocaleDateString("ja-JP"), situation:"", category:"", note:"", mood:3 });

      useEffect(() => { localStorage.setItem("tdl_sp_ratings", JSON.stringify(ratings)); }, [ratings]);
      useEffect(() => { localStorage.setItem("tdl_sp_diary",   JSON.stringify(diary));   }, [diary]);

      function getCategoryScore(catId) {
        const cat = SENSORY_CATEGORIES.find(c => c.id===catId);
        if (!cat) return 0;
        const total = cat.items.reduce((s,item) => s+(ratings[item.id]||0), 0);
        return Math.round((total/(cat.items.length*3))*100);
      }

      function saveEntry() {
        if (!newEntry.note.trim()) return;
        setDiary(prev => [{ ...newEntry, id:Date.now() }, ...prev]);
        setNewEntry({ date:new Date().toLocaleDateString("ja-JP"), situation:"", category:"", note:"", mood:3 });
        setAddingEntry(false);
      }

      // HOME
      if (screen === "home") return (
        <div style={{ minHeight:"100vh", background:"#f8fafc" }}>
          <div style={{ background:"linear-gradient(135deg,#f97316,#fb923c)", padding:"24px 20px 32px", color:"#fff" }}>
            <div style={{ maxWidth:600, margin:"0 auto" }}>
              <div style={{ fontSize:13, color:"#fed7aa", fontWeight:700, letterSpacing:1 }}>æ„Ÿè¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¦³å¯Ÿãƒãƒ¼ãƒˆ</div>
              <div style={{ fontSize:24, fontWeight:900, marginTop:4 }}>ğŸ” ã‹ã‚“ã•ã¤ï¼†ãã‚ã</div>
              <div style={{ fontSize:14, color:"#ffedd5", marginTop:6 }}>ãŠå­ã•ã‚“ã®æ„Ÿè¦šã®ç‰¹æ€§ã‚’è¦³å¯Ÿãƒ»è¨˜éŒ²ã™ã‚‹ãƒ„ãƒ¼ãƒ«</div>
            </div>
          </div>
          <div style={{ maxWidth:600, margin:"0 auto", padding:"20px 16px 80px" }}>
            <div style={{ display:"grid", gridTemplateColumns:"1fr 1fr", gap:14, marginBottom:24 }}>
              {[
                { id:"profile", icon:"ğŸ“Š", title:"æ„Ÿè¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«", desc:"6ã¤ã®æ„Ÿè¦šã‚’ãƒã‚§ãƒƒã‚¯", color:"#f97316" },
                { id:"diary",   icon:"ğŸ““", title:"ã‹ã‚“ã•ã¤ã«ã£ã",   desc:"æ°—ã«ãªã‚‹ã“ã¨ã‚’è¨˜éŒ²",   color:"#8b5cf6" },
                { id:"report",  icon:"ğŸ“ˆ", title:"ã¾ã¨ã‚ãƒ¬ãƒãƒ¼ãƒˆ",   desc:"è¨˜éŒ²ã‚’è¦‹ã‚„ã™ãæ•´ç†",   color:"#3b82f6" },
              ].map(item => (
                <div key={item.id} className="card" onClick={() => setScreen(item.id)} style={{
                  background:"#fff", borderRadius:20, padding:"22px 16px", textAlign:"center",
                  boxShadow:"0 2px 8px rgba(0,0,0,0.06)", border:`2px solid ${item.color}22`,
                  gridColumn: item.id==="report" ? "span 2" : "span 1",
                }}>
                  <div style={{ fontSize:40, marginBottom:10 }}>{item.icon}</div>
                  <div style={{ fontWeight:900, fontSize:15, color:"#1e293b" }}>{item.title}</div>
                  <div style={{ fontSize:12, color:"#94a3b8", marginTop:4 }}>{item.desc}</div>
                </div>
              ))}
            </div>
            <div style={{ background:"#fff7ed", borderRadius:16, padding:"16px 20px", border:"1px solid #fed7aa" }}>
              <div style={{ fontWeight:900, fontSize:14, color:"#9a3412", marginBottom:8 }}>âš ï¸ ã”æ³¨æ„</div>
              <div style={{ fontSize:12, color:"#7c2d12", lineHeight:1.7 }}>
                ã“ã®ã‚¢ãƒ—ãƒªã¯åŒ»ç™‚çš„è¨ºæ–­ã‚’è¡Œã†ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br/>
                æ—¥å¸¸ã®è¦³å¯Ÿã¨å·¥å¤«ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚<br/>
                å°‚é–€å®¶ã¸ã®ç›¸è«‡ã¯åˆ¥é€”ã”æ¤œè¨ãã ã•ã„ã€‚
              </div>
            </div>
          </div>
        </div>
      );

      // PROFILE
      if (screen === "profile") return (
        <div style={{ minHeight:"100vh", background:"#f8fafc" }}>
          <div style={{ background:"linear-gradient(135deg,#f97316,#fb923c)", padding:"20px 20px 28px", color:"#fff" }}>
            <div style={{ maxWidth:640, margin:"0 auto" }}>
              <button className="btn" onClick={() => setScreen("home")} style={{ background:"rgba(255,255,255,0.2)", color:"#fff", borderRadius:10, padding:"6px 14px", fontSize:13, fontWeight:800, marginBottom:12 }}>â† ã‚‚ã©ã‚‹</button>
              <div style={{ fontSize:20, fontWeight:900 }}>ğŸ“Š æ„Ÿè¦šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</div>
              <div style={{ fontSize:13, color:"#fed7aa", marginTop:4 }}>ãã‚Œãã‚Œã®æ§˜å­ã‚’ãˆã‚‰ã‚“ã§ãã ã•ã„</div>
            </div>
          </div>
          <div style={{ maxWidth:640, margin:"0 auto", padding:"20px 16px 80px" }}>
            {SENSORY_CATEGORIES.map(cat => (
              <div key={cat.id} style={{ background:"#fff", borderRadius:20, marginBottom:14, boxShadow:"0 2px 8px rgba(0,0,0,0.06)", overflow:"hidden" }}>
                <div onClick={() => setExpandedCat(expandedCat===cat.id ? null : cat.id)}
                  style={{ padding:"16px 20px", display:"flex", alignItems:"center", gap:12, cursor:"pointer", background:expandedCat===cat.id?cat.light:"#fff", transition:"background 0.2s" }}>
                  <div style={{ width:44, height:44, borderRadius:14, background:`${cat.color}20`, display:"flex", alignItems:"center", justifyContent:"center", fontSize:24 }}>{cat.icon}</div>
                  <div style={{ flex:1 }}>
                    <div style={{ fontWeight:900, fontSize:15, color:"#1e293b" }}>{cat.label}</div>
                    <div style={{ fontSize:12, color:"#94a3b8", marginTop:2 }}>{cat.items.length}é …ç›®</div>
                  </div>
                  <div style={{ textAlign:"right" }}>
                    <div style={{ fontSize:18, fontWeight:900, color:cat.color }}>{getCategoryScore(cat.id)}%</div>
                    <div style={{ fontSize:20 }}>{expandedCat===cat.id?"â–²":"â–¼"}</div>
                  </div>
                </div>
                {expandedCat===cat.id && (
                  <div style={{ padding:"0 16px 16px" }}>
                    {cat.items.map(item => (
                      <div key={item.id} style={{ padding:"12px 0", borderBottom:"1px solid #f1f5f9" }}>
                        <div style={{ fontSize:14, fontWeight:700, color:"#374151", marginBottom:10 }}>{item.label}</div>
                        <div style={{ display:"flex", gap:6 }}>
                          {FREQ.map(opt => (
                            <button key={opt.value} className="freq-btn" onClick={() => setRatings(p => ({ ...p, [item.id]:opt.value }))} style={{
                              flex:1, padding:"8px 4px", borderRadius:10,
                              background: ratings[item.id]===opt.value ? opt.color : "#f1f5f9",
                              color: ratings[item.id]===opt.value ? "#fff" : "#64748b",
                              fontSize:11, fontWeight:800,
                            }}>{opt.label}</button>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            ))}
          </div>
        </div>
      );

      // DIARY
      if (screen === "diary") return (
        <div style={{ minHeight:"100vh", background:"#f8fafc" }}>
          <div style={{ background:"linear-gradient(135deg,#7c3aed,#8b5cf6)", padding:"20px 20px 28px", color:"#fff" }}>
            <div style={{ maxWidth:640, margin:"0 auto" }}>
              <button className="btn" onClick={() => setScreen("home")} style={{ background:"rgba(255,255,255,0.2)", color:"#fff", borderRadius:10, padding:"6px 14px", fontSize:13, fontWeight:800, marginBottom:12 }}>â† ã‚‚ã©ã‚‹</button>
              <div style={{ fontSize:20, fontWeight:900 }}>ğŸ““ ã‹ã‚“ã•ã¤ã«ã£ã</div>
              <div style={{ fontSize:13, color:"#ddd6fe", marginTop:4 }}>æ°—ã«ãªã£ãŸã“ã¨ã‚’ãƒ¡ãƒ¢ã—ã‚ˆã†</div>
            </div>
          </div>
          <div style={{ maxWidth:640, margin:"0 auto", padding:"20px 16px 80px" }}>
            {!addingEntry && (
              <button className="btn" onClick={() => setAddingEntry(true)} style={{ width:"100%", padding:"16px", borderRadius:16, fontSize:15, fontWeight:900, background:"linear-gradient(135deg,#7c3aed,#8b5cf6)", color:"#fff", boxShadow:"0 4px 16px rgba(124,58,237,0.3)", marginBottom:20 }}>
                ï¼‹ ãã‚ãã‚’ã¤ã„ã‹
              </button>
            )}
            {addingEntry && (
              <div style={{ background:"#fff", borderRadius:20, padding:20, marginBottom:20, boxShadow:"0 4px 16px rgba(0,0,0,0.08)" }}>
                <div style={{ fontWeight:900, fontSize:15, marginBottom:16, color:"#374151" }}>ğŸ“ ã‚ãŸã‚‰ã—ã„ãã‚ã</div>
                <div style={{ marginBottom:16 }}>
                  <div style={{ fontSize:13, fontWeight:800, color:"#64748b", marginBottom:8 }}>å­ã©ã‚‚ã®æ§˜å­</div>
                  <div style={{ display:"flex", gap:10, justifyContent:"center" }}>
                    {MOODS.map((m,i) => (
                      <span key={i} onClick={() => setNewEntry(e => ({ ...e, mood:i }))}
                        style={{ fontSize:32, cursor:"pointer", opacity:newEntry.mood===i?1:0.35, transition:"all 0.15s", transform:newEntry.mood===i?"scale(1.3)":"scale(1)" }}>{m}</span>
                    ))}
                  </div>
                </div>
                <div style={{ marginBottom:12 }}>
                  <div style={{ fontSize:13, fontWeight:800, color:"#64748b", marginBottom:8 }}>ã„ã¤ãƒ»ã©ã“ã§</div>
                  <div style={{ display:"flex", flexWrap:"wrap", gap:6 }}>
                    {SITUATIONS.map(s => (
                      <span key={s} onClick={() => setNewEntry(e => ({ ...e, situation:s }))}
                        style={{ padding:"6px 14px", borderRadius:99, fontSize:13, fontWeight:800, cursor:"pointer", background:newEntry.situation===s?"#7c3aed":"#f1f5f9", color:newEntry.situation===s?"#fff":"#64748b", transition:"all 0.15s" }}>{s}</span>
                    ))}
                  </div>
                </div>
                <div style={{ marginBottom:12 }}>
                  <div style={{ fontSize:13, fontWeight:800, color:"#64748b", marginBottom:8 }}>ã‹ã‚“ã‹ãã®ã—ã‚…ã‚‹ã„</div>
                  <div style={{ display:"flex", flexWrap:"wrap", gap:6 }}>
                    {SENSORY_CATEGORIES.map(c => (
                      <span key={c.id} onClick={() => setNewEntry(e => ({ ...e, category:c.id }))}
                        style={{ padding:"6px 14px", borderRadius:99, fontSize:13, fontWeight:800, cursor:"pointer", background:newEntry.category===c.id?c.color:"#f1f5f9", color:newEntry.category===c.id?"#fff":"#64748b", transition:"all 0.15s" }}>
                        {c.icon} {c.label}
                      </span>
                    ))}
                  </div>
                </div>
                <div style={{ background:"#f5f3ff", borderRadius:12, padding:"10px 14px", marginBottom:10 }}>
                  <div style={{ fontSize:12, color:"#7c3aed", fontWeight:800, marginBottom:4 }}>ğŸ’¡ ã‹ããƒã‚¤ãƒ³ãƒˆ</div>
                  <div style={{ display:"flex", flexWrap:"wrap", gap:6 }}>
                    {MEMO_PROMPTS.map(p => <span key={p} style={{ fontSize:11, color:"#6d28d9", background:"#ede9fe", padding:"3px 8px", borderRadius:6 }}>{p}</span>)}
                  </div>
                </div>
                <textarea value={newEntry.note} onChange={e => setNewEntry(n => ({ ...n, note:e.target.value }))}
                  placeholder="æ°—ã«ãªã£ãŸã“ã¨ã‚’è‡ªç”±ã«ãƒ¡ãƒ¢â€¦"
                  style={{ width:"100%", border:"2px solid #e5e7eb", borderRadius:12, padding:"12px", fontSize:14, resize:"vertical", minHeight:100, outline:"none", lineHeight:1.6 }} />
                <div style={{ display:"flex", gap:10, marginTop:12 }}>
                  <button className="btn" onClick={() => setAddingEntry(false)} style={{ flex:1, padding:"12px", borderRadius:12, background:"#f1f5f9", color:"#64748b", fontWeight:900, fontSize:14 }}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                  <button className="btn" onClick={saveEntry} style={{ flex:2, padding:"12px", borderRadius:12, background:"#7c3aed", color:"#fff", fontWeight:900, fontSize:14, boxShadow:"0 3px 10px rgba(124,58,237,0.3)" }}>ğŸ’¾ ã»ãã‚“ã™ã‚‹</button>
                </div>
              </div>
            )}
            {diary.length===0 ? (
              <div style={{ textAlign:"center", padding:"40px 20px", color:"#94a3b8", fontSize:14, fontWeight:700 }}>
                <div style={{ fontSize:48, marginBottom:12 }}>ğŸ““</div>
                ãã‚ããŒã¾ã ã‚ã‚Šã¾ã›ã‚“<br/>ã€Œï¼‹ãã‚ãã‚’ã¤ã„ã‹ã€ã‹ã‚‰ã¯ã˜ã‚ã‚ˆã†
              </div>
            ) : (
              <div style={{ display:"flex", flexDirection:"column", gap:12 }}>
                {diary.map(entry => {
                  const cat = SENSORY_CATEGORIES.find(c => c.id===entry.category);
                  return (
                    <div key={entry.id} style={{ background:"#fff", borderRadius:16, padding:"16px 18px", boxShadow:"0 2px 8px rgba(0,0,0,0.05)", borderLeft:`4px solid ${cat?.color||"#e5e7eb"}` }}>
                      <div style={{ display:"flex", alignItems:"flex-start", gap:10, marginBottom:8 }}>
                        <span style={{ fontSize:24 }}>{MOODS[entry.mood]}</span>
                        <div style={{ flex:1 }}>
                          <div style={{ display:"flex", gap:6, flexWrap:"wrap", marginBottom:4 }}>
                            {entry.situation && <span style={{ fontSize:11, fontWeight:800, background:"#f1f5f9", color:"#64748b", padding:"2px 8px", borderRadius:99 }}>{entry.situation}</span>}
                            {cat && <span style={{ fontSize:11, fontWeight:800, background:`${cat.color}15`, color:cat.color, padding:"2px 8px", borderRadius:99 }}>{cat.icon} {cat.label}</span>}
                          </div>
                          <div style={{ fontSize:12, color:"#94a3b8" }}>{entry.date}</div>
                        </div>
                        <button className="btn" onClick={() => setDiary(p => p.filter(e => e.id!==entry.id))} style={{ color:"#ef4444", background:"#fee2e2", borderRadius:8, padding:"4px 8px", fontSize:11, fontWeight:900 }}>å‰Šé™¤</button>
                      </div>
                      <div style={{ fontSize:14, color:"#374151", lineHeight:1.6 }}>{entry.note}</div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        </div>
      );

      // REPORT
      return (
        <div style={{ minHeight:"100vh", background:"#f8fafc" }}>
          <div style={{ background:"linear-gradient(135deg,#1d4ed8,#3b82f6)", padding:"20px 20px 28px", color:"#fff" }}>
            <div style={{ maxWidth:640, margin:"0 auto" }}>
              <button className="btn" onClick={() => setScreen("home")} style={{ background:"rgba(255,255,255,0.2)", color:"#fff", borderRadius:10, padding:"6px 14px", fontSize:13, fontWeight:800, marginBottom:12 }}>â† ã‚‚ã©ã‚‹</button>
              <div style={{ fontSize:20, fontWeight:900 }}>ğŸ“ˆ ã¾ã¨ã‚ãƒ¬ãƒãƒ¼ãƒˆ</div>
            </div>
          </div>
          <div style={{ maxWidth:640, margin:"0 auto", padding:"20px 16px 80px" }}>
            <div style={{ background:"#fff", borderRadius:20, padding:24, marginBottom:16, boxShadow:"0 2px 8px rgba(0,0,0,0.06)" }}>
              <div style={{ fontWeight:900, fontSize:15, marginBottom:20, color:"#1e293b" }}>æ„Ÿè¦šã”ã¨ã®å‚¾å‘</div>
              {SENSORY_CATEGORIES.map(cat => {
                const score = getCategoryScore(cat.id);
                const label = score<20?"ãŠã ã‚„ã‹":score<50?"ãµã¤ã†":score<75?"ã‚„ã‚„éæ•":"ã¨ã¦ã‚‚éæ•";
                return (
                  <div key={cat.id} style={{ marginBottom:14 }}>
                    <div style={{ display:"flex", alignItems:"center", gap:10, marginBottom:6 }}>
                      <span style={{ fontSize:20 }}>{cat.icon}</span>
                      <span style={{ fontSize:13, fontWeight:800, flex:1, color:"#374151" }}>{cat.label}</span>
                      <span style={{ fontSize:12, fontWeight:900, color:cat.color }}>{label}</span>
                      <span style={{ fontSize:13, fontWeight:900, color:cat.color, width:36, textAlign:"right" }}>{score}%</span>
                    </div>
                    <div style={{ height:10, background:"#f1f5f9", borderRadius:99, overflow:"hidden" }}>
                      <div className="bar" style={{ height:"100%", width:`${score}%`, background:cat.color, borderRadius:99 }} />
                    </div>
                  </div>
                );
              })}
            </div>
            <div style={{ background:"#fff", borderRadius:20, padding:24, marginBottom:16, boxShadow:"0 2px 8px rgba(0,0,0,0.06)" }}>
              <div style={{ fontWeight:900, fontSize:15, marginBottom:16, color:"#1e293b" }}>ğŸ““ ã«ã£ãã®ã¾ã¨ã‚</div>
              <div style={{ display:"grid", gridTemplateColumns:"1fr 1fr 1fr", gap:12 }}>
                {[
                  { label:"ãã‚ãæ•°", value:diary.length, color:"#3b82f6", display: String(diary.length) },
                  { label:"å¹³å‡ãã¶ã‚“", value:0, color:"#f59e0b", display: diary.length>0 ? MOODS[Math.round(diary.reduce((s,e)=>s+e.mood,0)/diary.length)] : "â€”" },
                  { label:"å¤šã„ã‹ã‚“ã‹ã", value:0, color:"#8b5cf6", display: (() => { if (!diary.length) return "â€”"; const c={}; diary.forEach(e=>{if(e.category)c[e.category]=(c[e.category]||0)+1;}); const t=Object.entries(c).sort((a,b)=>b[1]-a[1])[0]; return t?SENSORY_CATEGORIES.find(x=>x.id===t[0])?.icon||"â€”":"â€”"; })() },
                ].map(s => (
                  <div key={s.label} style={{ textAlign:"center", background:"#f8fafc", borderRadius:14, padding:"14px 8px" }}>
                    <div style={{ fontSize:24, fontWeight:900, color:s.color }}>{s.display}</div>
                    <div style={{ fontSize:11, color:"#64748b", fontWeight:700 }}>{s.label}</div>
                  </div>
                ))}
              </div>
            </div>
            {diary.length>0 && (
              <div style={{ background:"#fff", borderRadius:20, padding:24, boxShadow:"0 2px 8px rgba(0,0,0,0.06)" }}>
                <div style={{ fontWeight:900, fontSize:15, marginBottom:16, color:"#1e293b" }}>ğŸ“ ã©ã“ã§ãŠãŠã„ï¼Ÿ</div>
                {SITUATIONS.filter(s => diary.some(e => e.situation===s)).map(sit => {
                  const count = diary.filter(e => e.situation===sit).length;
                  const pct   = Math.round((count/diary.length)*100);
                  return (
                    <div key={sit} style={{ marginBottom:10 }}>
                      <div style={{ display:"flex", justifyContent:"space-between", marginBottom:4 }}>
                        <span style={{ fontSize:13, fontWeight:800, color:"#374151" }}>{sit}</span>
                        <span style={{ fontSize:13, fontWeight:900, color:"#f97316" }}>{count}ä»¶</span>
                      </div>
                      <div style={{ height:8, background:"#f1f5f9", borderRadius:99, overflow:"hidden" }}>
                        <div className="bar" style={{ height:"100%", width:`${pct}%`, background:"#f97316", borderRadius:99 }} />
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<SensoryProfile />);
  </script>
  <a class="home-btn" href="index.html">ğŸ  ãƒ›ãƒ¼ãƒ ã¸</a>
</body>
</html>
