<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ãƒ©ã‚¤ãƒ•ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒœãƒ¼ãƒ‰ã€ä½“é¨“ç‰ˆã€‘</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;800;900&family=Zen+Kaku+Gothic+New:wght@400;700;900&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Zen Kaku Gothic New','Nunito', sans-serif;
      background: linear-gradient(160deg,#1e1b4b 0%,#312e81 40%,#4c1d95 100%);
      min-height: 100vh; color: #fff;
    }

    /* â”€â”€ ä½“é¨“ç‰ˆãƒãƒŠãƒ¼ â”€â”€ */
    .taiken-banner {
      background: linear-gradient(90deg,rgba(251,191,36,0.22),rgba(251,191,36,0.10));
      border-bottom: 1px solid rgba(251,191,36,0.35);
      padding: 9px 16px; text-align: center;
      font-size: 12px; font-weight: 800; color: #fde68a; letter-spacing: 0.05em;
    }
    .taiken-banner strong { color: #fbbf24; }

    /* â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€ */
    .hd {
      background: rgba(0,0,0,0.35); border-bottom: 1px solid rgba(255,255,255,0.1);
      padding: 14px 16px;
    }
    .hd-inner { max-width: 600px; margin: 0 auto; display: flex; align-items: center; gap: 14px; }
    .hd-icon { font-size: 34px; }
    .hd-info { flex: 1; }
    .hd-label { font-size: 11px; color: #fbbf24; font-weight: 800; letter-spacing: 1px; margin-bottom: 2px; }
    .hd-rank  { font-size: 17px; font-weight: 900; }
    .xp-bar   { height: 8px; background: rgba(255,255,255,0.15); border-radius: 99px; margin-top: 5px; overflow: hidden; }
    .xp-fill  { height: 100%; border-radius: 99px; transition: width 0.7s cubic-bezier(.4,0,.2,1); }
    .hd-xp    { text-align: right; font-size: 20px; font-weight: 900; color: #fbbf24; }
    .hd-xp small { font-size: 10px; color: #fde68a; }

    /* â”€â”€ ã‚¿ãƒ– â”€â”€ */
    .tabs {
      background: rgba(0,0,0,0.22); border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .tabs-inner { max-width: 600px; margin: 0 auto; display: flex; }
    .tab-btn {
      flex: 1; padding: 13px 0; border: none; background: none; cursor: pointer;
      font-family: 'Zen Kaku Gothic New','Nunito',sans-serif;
      font-size: 13px; font-weight: 900; color: #a78bfa;
      border-bottom: 3px solid transparent; transition: all 0.15s;
    }
    .tab-btn.active { color: #fff; border-bottom-color: #a5b4fc; }
    .tab-btn.locked { color: rgba(167,139,250,0.38); cursor: pointer; }

    /* â”€â”€ ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ â”€â”€ */
    .content { max-width: 600px; margin: 0 auto; padding: 18px 14px 120px; }

    /* â”€â”€ é€²è¡Œãƒãƒ¼ â”€â”€ */
    .progress-box {
      background: rgba(255,255,255,0.08); border-radius: 16px;
      padding: 14px 18px; margin-bottom: 18px;
      display: flex; align-items: center; gap: 14px;
    }
    .progress-emoji { font-size: 38px; }
    .progress-info { flex: 1; }
    .progress-label { font-weight: 900; font-size: 15px; }
    .progress-bar { height: 8px; background: rgba(255,255,255,0.15); border-radius: 99px; margin-top: 6px; overflow: hidden; }
    .progress-fill { height: 100%; border-radius: 99px; background: linear-gradient(90deg,#34d399,#6ee7b7); transition: width 0.7s cubic-bezier(.4,0,.2,1); }
    .reset-btn {
      font-size: 11px; background: rgba(255,255,255,0.1); border: none;
      color: #c4b5fd; border-radius: 8px; padding: 6px 10px; cursor: pointer;
      font-family: inherit; font-weight: 700;
    }
    .reset-btn:hover { background: rgba(255,255,255,0.18); }

    /* â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ« â”€â”€ */
    .section-title {
      font-weight: 900; font-size: 14px; margin-bottom: 10px; color: #c4b5fd;
    }
    .section-title.locked-title { color: rgba(196,181,253,0.35); }

    /* â”€â”€ ã‚¯ã‚¨ã‚¹ãƒˆã‚°ãƒªãƒƒãƒ‰ â”€â”€ */
    .quest-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 22px; }
    .quest-card {
      background: rgba(255,255,255,0.07); border: 2px solid rgba(255,255,255,0.1);
      border-radius: 16px; padding: 16px 10px; text-align: center; cursor: pointer;
      transition: all 0.18s cubic-bezier(.4,2,.6,1);
      display: flex; flex-direction: column; align-items: center; gap: 7px;
    }
    .quest-card:hover { transform: scale(1.04) translateY(-2px); }
    .quest-card.done {
      background: rgba(52,211,153,0.15); border-color: #34d399; opacity: 0.6;
    }
    .quest-icon { font-size: 36px; }
    .quest-label { font-weight: 800; font-size: 13px; }
    .quest-xp {
      font-size: 11px; font-weight: 700; padding: 3px 10px; border-radius: 99px;
      background: rgba(165,180,252,0.15); color: #a5b4fc;
    }
    .quest-card.done .quest-xp { background: rgba(52,211,153,0.15); color: #34d399; }

    /* â”€â”€ ãƒ­ãƒƒã‚¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â”€â”€ */
    .locked-section {
      background: rgba(255,255,255,0.04);
      border: 1.5px dashed rgba(167,139,250,0.22);
      border-radius: 16px; padding: 16px; text-align: center;
      color: rgba(167,139,250,0.45); font-size: 13px; font-weight: 700;
      margin-bottom: 22px;
    }

    /* â”€â”€ XPãƒˆãƒ¼ã‚¹ãƒˆ â”€â”€ */
    .xp-toast {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%);
      background: #fbbf24; color: #1e1b4b; font-size: 1.9rem; font-weight: 900;
      padding: 14px 36px; border-radius: 999px; z-index: 9999;
      box-shadow: 0 8px 32px rgba(251,191,36,0.6); pointer-events: none;
      animation: toast-anim 1.6s ease forwards;
    }
    @keyframes toast-anim {
      0%  { opacity:0; transform:translate(-50%,-62%); }
      18% { opacity:1; transform:translate(-50%,-50%); }
      80% { opacity:1; }
      100%{ opacity:0; transform:translate(-50%,-38%); }
    }

    /* â”€â”€ ã‚³ãƒ³ãƒ•ã‚§ãƒƒãƒ†ã‚£ â”€â”€ */
    @keyframes fall0 { to { top:110%; transform:rotate(360deg) translateX(30px); } }
    @keyframes fall1 { to { top:110%; transform:rotate(-360deg) translateX(-20px); } }
    @keyframes fall2 { to { top:110%; transform:rotate(180deg) translateX(40px); } }
    @keyframes fall3 { to { top:110%; transform:rotate(-180deg) translateX(-35px); } }

    /* â”€â”€ CTA â”€â”€ */
    .cta-block {
      background: linear-gradient(135deg,rgba(124,58,237,0.28),rgba(76,29,149,0.38));
      border: 1px solid rgba(167,139,250,0.28); border-radius: 20px;
      padding: 22px 18px; text-align: center; margin-top: 8px;
    }
    .cta-eyebrow { font-size: 11px; font-weight: 900; letter-spacing: 0.15em; color: #a78bfa; text-transform: uppercase; margin-bottom: 8px; }
    .cta-text { font-size: 14px; font-weight: 800; color: #e0e0ff; line-height: 1.7; margin-bottom: 16px; }
    .cta-btn {
      display: inline-block;
      background: linear-gradient(135deg,#c8a97e,#d4b896);
      color: #fff; font-size: 14px; font-weight: 900;
      padding: 13px 26px; border-radius: 99px;
      text-decoration: none;
      box-shadow: 0 6px 20px rgba(200,169,126,0.4);
      font-family: 'Zen Kaku Gothic New','Nunito',sans-serif;
      transition: all 0.18s cubic-bezier(.34,1.4,.64,1);
    }
    .cta-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 28px rgba(200,169,126,0.5); }

    /* â”€â”€ ãƒ­ãƒƒã‚¯ãƒšãƒ¼ã‚¸ â”€â”€ */
    .lock-page { padding: 32px 16px; text-align: center; }
    .lock-big { font-size: 60px; margin-bottom: 14px; }
    .lock-ttl { font-size: 19px; font-weight: 900; margin-bottom: 10px; }
    .lock-sub { font-size: 13px; color: #a5b4fc; line-height: 1.8; margin-bottom: 22px; }
    .lock-features {
      background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);
      border-radius: 16px; padding: 18px 20px; text-align: left; margin-bottom: 24px;
    }
    .lock-feat-ttl { font-size: 11px; font-weight: 900; color: #a78bfa; letter-spacing: 0.12em; text-transform: uppercase; margin-bottom: 12px; }
    .lock-feat-item { font-size: 13px; font-weight: 700; color: #c4b5fd; margin-bottom: 8px; display: flex; gap: 8px; }

    /* hidden */
    .hidden { display: none !important; }
  </style>
</head>
<body>

<!-- ä½“é¨“ç‰ˆãƒãƒŠãƒ¼ -->
<div class="taiken-banner">
  âš ï¸ ã“ã‚Œã¯<strong>ä½“é¨“ç‰ˆ</strong>ã§ã™ã€€ï¼ã€€ä¸€éƒ¨æ©Ÿèƒ½ã¯ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™
</div>

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<div class="hd">
  <div class="hd-inner">
    <div class="hd-icon">ğŸ—¡ï¸</div>
    <div class="hd-info">
      <div class="hd-label">ã€ä½“é¨“ç‰ˆã€‘ãƒ©ã‚¤ãƒ•ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒœãƒ¼ãƒ‰</div>
      <div class="hd-rank" id="rankName">ã¿ãªã‚‰ã„ã¼ã†ã‘ã‚“ã—ã‚ƒ</div>
      <div class="xp-bar"><div class="xp-fill" id="xpFill" style="width:0%;background:linear-gradient(90deg,#94a3b8,#fff)"></div></div>
    </div>
    <div class="hd-xp"><span id="xpVal">0</span><small>XP</small></div>
  </div>
</div>

<!-- ã‚¿ãƒ– -->
<div class="tabs">
  <div class="tabs-inner">
    <button class="tab-btn active" id="tab-board" onclick="switchTab('board')">ğŸ—ºï¸ ã‚¯ã‚¨ã‚¹ãƒˆ</button>
    <button class="tab-btn locked" id="tab-hero"  onclick="switchTab('hero')">ğŸ§ ãƒ’ãƒ¼ãƒ­ãƒ¼ ğŸ”’</button>
    <button class="tab-btn locked" id="tab-shop"  onclick="switchTab('shop')">ğŸª ã‚·ãƒ§ãƒƒãƒ— ğŸ”’</button>
  </div>
</div>

<!-- BOARD -->
<div class="content" id="page-board">

  <!-- é€²è¡ŒçŠ¶æ³ -->
  <div class="progress-box">
    <div class="progress-emoji" id="progressEmoji">âš”ï¸</div>
    <div class="progress-info">
      <div class="progress-label" id="progressLabel">æœã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ 0 / 4</div>
      <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
    </div>
    <button class="reset-btn" onclick="resetDay()">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>

  <!-- æœãƒŸãƒƒã‚·ãƒ§ãƒ³ï¼ˆä½“é¨“ç‰ˆ: 4ã¤å‹•ä½œï¼‰ -->
  <div class="section-title">ğŸŒ… ã‚ã•ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³</div>
  <div class="quest-grid" id="questGrid">
    <!-- JSã§æŒ¿å…¥ -->
  </div>

  <!-- ã²ã‚‹ãƒŸãƒƒã‚·ãƒ§ãƒ³ ãƒ­ãƒƒã‚¯ -->
  <div class="section-title locked-title">â˜€ï¸ ã²ã‚‹ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ã€€<span style="font-size:12px">ğŸ”’ è£½å“ç‰ˆ</span></div>
  <div class="locked-section">ğŸ”’ è£½å“ç‰ˆã§è§£æ”¾ã•ã‚Œã¾ã™ï¼ˆ3ã‚¯ã‚¨ã‚¹ãƒˆï¼‰</div>

  <!-- ã‚ˆã‚‹ãƒŸãƒƒã‚·ãƒ§ãƒ³ ãƒ­ãƒƒã‚¯ -->
  <div class="section-title locked-title">ğŸŒ™ ã‚ˆã‚‹ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ã€€<span style="font-size:12px">ğŸ”’ è£½å“ç‰ˆ</span></div>
  <div class="locked-section">ğŸ”’ è£½å“ç‰ˆã§è§£æ”¾ã•ã‚Œã¾ã™ï¼ˆ4ã‚¯ã‚¨ã‚¹ãƒˆï¼‰</div>

  <!-- CTA -->
  <div class="cta-block">
    <div class="cta-eyebrow">ï¼¼ ãƒ•ãƒ«æ©Ÿèƒ½ã¯ã“ã¡ã‚‰ ï¼</div>
    <div class="cta-text">ã²ã‚‹ãƒ»ã‚ˆã‚‹ã®ãƒŸãƒƒã‚·ãƒ§ãƒ³<br>ãƒ’ãƒ¼ãƒ­ãƒ¼è‚²æˆãƒ»ã‚·ãƒ§ãƒƒãƒ—æ©Ÿèƒ½<br>ã™ã¹ã¦ä½¿ã„æ”¾é¡Œ</div>
    <a class="cta-btn"https://buy.stripe.com/fZu7sN5EW1aa96Gfcz73G08" target="_blank">ãƒ©ã‚¤ãƒ•ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒœãƒ¼ãƒ‰ã‚’è³¼å…¥ã™ã‚‹ â†’</a>
  </div>
</div>

<!-- HERO ãƒ­ãƒƒã‚¯ -->
<div class="content hidden" id="page-hero">
  <div class="lock-page">
    <div class="lock-big">ğŸ”’</div>
    <div class="lock-ttl">ğŸ§ ãƒ’ãƒ¼ãƒ­ãƒ¼ãƒšãƒ¼ã‚¸ã¯è£½å“ç‰ˆã§è§£æ”¾ã•ã‚Œã¾ã™</div>
    <div class="lock-sub">ã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¦XPã‚’è²¯ã‚ã€ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚’è‚²ã¦ã‚‹æ©Ÿèƒ½ã§ã™ã€‚</div>
    <div class="lock-features">
      <div class="lock-feat-ttl">è£½å“ç‰ˆã§ä½¿ãˆã‚‹æ©Ÿèƒ½</div>
      <div class="lock-feat-item">âœ” ãƒ©ãƒ³ã‚¯ã‚¢ãƒƒãƒ—ã§ãƒ’ãƒ¼ãƒ­ãƒ¼ãŒæˆé•·</div>
      <div class="lock-feat-item">âœ” ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆXPãƒ»ã‚³ã‚¤ãƒ³ãƒ»ã‚¯ãƒªã‚¢æ•°ï¼‰</div>
      <div class="lock-feat-item">âœ” ã‚²ãƒƒãƒˆã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã‚’è£…å‚™</div>
      <div class="lock-feat-item">âœ” å…¨6æ®µéšã®ãƒ©ãƒ³ã‚¯è§£æ”¾</div>
    </div>
    <div class="cta-block">
      <div class="cta-eyebrow">ï¼¼ ãƒ•ãƒ«æ©Ÿèƒ½ã¯ã“ã¡ã‚‰ ï¼</div>
      <div class="cta-text">ãƒ’ãƒ¼ãƒ­ãƒ¼è‚²æˆãƒ»ã‚·ãƒ§ãƒƒãƒ—ãƒ»å…¨12ã‚¯ã‚¨ã‚¹ãƒˆ<br>ã™ã¹ã¦ä½¿ã„æ”¾é¡Œ</div>
      <a class="cta-btn" href="https://buy.stripe.com/fZu7sN5EW1aa96Gfcz73G08" target="_blank">ãƒ©ã‚¤ãƒ•ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒœãƒ¼ãƒ‰ã‚’è³¼å…¥ã™ã‚‹ â†’</a>
    </div>
  </div>
</div>

<!-- SHOP ãƒ­ãƒƒã‚¯ -->
<div class="content hidden" id="page-shop">
  <div class="lock-page">
    <div class="lock-big">ğŸ”’</div>
    <div class="lock-ttl">ğŸª ã‚·ãƒ§ãƒƒãƒ—æ©Ÿèƒ½ã¯è£½å“ç‰ˆé™å®šã§ã™</div>
    <div class="lock-sub">ã‚¯ã‚¨ã‚¹ãƒˆã§è²¯ã‚ãŸã‚³ã‚¤ãƒ³ã§ã‚¢ã‚¤ãƒ†ãƒ ã‚’è³¼å…¥ã—ã€ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚’è£…å‚™ã§ãã¾ã™ã€‚</div>
    <div class="lock-features">
      <div class="lock-feat-ttl">è£½å“ç‰ˆã§ä½¿ãˆã‚‹æ©Ÿèƒ½</div>
      <div class="lock-feat-item">âœ” 8ç¨®é¡ã®ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆå‰£ãƒ»ç›¾ãƒ»ç‹å† ãªã©ï¼‰</div>
      <div class="lock-feat-item">âœ” ã‚³ã‚¤ãƒ³ã§ã‚¢ã‚¤ãƒ†ãƒ ã‚’è³¼å…¥</div>
      <div class="lock-feat-item">âœ” ãƒ’ãƒ¼ãƒ­ãƒ¼ã«è£…å‚™ã—ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</div>
      <div class="lock-feat-item">âœ” ãƒ¬ã‚¢ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç›®æŒ‡ã—ã¦ãƒ¢ãƒãƒ™UP</div>
    </div>
    <div class="cta-block">
      <div class="cta-eyebrow">ï¼¼ ãƒ•ãƒ«æ©Ÿèƒ½ã¯ã“ã¡ã‚‰ ï¼</div>
      <div class="cta-text">ãƒ’ãƒ¼ãƒ­ãƒ¼è‚²æˆãƒ»ã‚·ãƒ§ãƒƒãƒ—ãƒ»å…¨12ã‚¯ã‚¨ã‚¹ãƒˆ<br>ã™ã¹ã¦ä½¿ã„æ”¾é¡Œ</div>
      <a class="cta-btn" href="https://buy.stripe.com/fZu7sN5EW1aa96Gfcz73G08" target="_blank">ãƒ©ã‚¤ãƒ•ãƒ»ã‚¯ã‚¨ã‚¹ãƒˆãƒ»ãƒœãƒ¼ãƒ‰ã‚’è³¼å…¥ã™ã‚‹ â†’</a>
    </div>
  </div>
</div>

<!-- ã‚³ãƒ³ãƒ•ã‚§ãƒƒãƒ†ã‚£ã‚³ãƒ³ãƒ†ãƒŠ -->
<div id="confetti-container" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9997;"></div>
<!-- XPãƒˆãƒ¼ã‚¹ãƒˆ -->
<div class="xp-toast hidden" id="xpToast"></div>

<script>
  // â”€â”€ ãƒ‡ãƒ¼ã‚¿ â”€â”€
  var QUESTS = [
    { id:"teeth",     icon:"ğŸ¦·", label:"æ­¯ã¿ãŒã",  xp:20 },
    { id:"wash",      icon:"ğŸ§¼", label:"ã¦ã‚ã‚‰ã„",  xp:15 },
    { id:"dress",     icon:"ğŸ‘•", label:"ããŒãˆ",    xp:25 },
    { id:"breakfast", icon:"ğŸš", label:"ã”ã¯ã‚“",    xp:30 },
  ];

  var RANKS = [
    { name:"ã¿ãªã‚‰ã„ã¼ã†ã‘ã‚“ã—ã‚ƒ", min:0,   color:"#94a3b8" },
    { name:"ã¿ãªã‚‰ã„ãã—",         min:50,  color:"#a78bfa" },
    { name:"ã‚†ã†ã‹ã‚“ãªãã—",       min:90,  color:"#60a5fa" },
    { name:"ã§ã‚“ã›ã¤ã®ã‚†ã†ã—ã‚ƒ",   min:300, color:"#fbbf24" },
  ];

  var CONFETTI_COLORS = ["#fbbf24","#f87171","#34d399","#60a5fa","#a78bfa","#fb923c"];

  // â”€â”€ çŠ¶æ…‹ â”€â”€
  var completed = [];
  var totalXP   = 0;

  // â”€â”€ åˆæœŸæç”» â”€â”€
  renderQuests();
  updateHeader();

  function renderQuests() {
    var grid = document.getElementById("questGrid");
    grid.innerHTML = "";
    QUESTS.forEach(function(q) {
      var done = completed.indexOf(q.id) !== -1;
      var card = document.createElement("div");
      card.className = "quest-card" + (done ? " done" : "");
      card.innerHTML =
        '<div class="quest-icon">' + q.icon + '</div>' +
        '<div class="quest-label">' + q.label + '</div>' +
        '<div class="quest-xp">' + (done ? "âœ… ã‚¯ãƒªã‚¢ï¼" : "+" + q.xp + " XP") + '</div>';
      if (!done) {
        card.addEventListener("click", function() { completeQuest(q); });
      }
      grid.appendChild(card);
    });
    updateProgress();
  }

  function updateProgress() {
    var done = completed.length;
    var total = QUESTS.length;
    var all = done === total;
    document.getElementById("progressEmoji").textContent = all ? "ğŸ†" : "âš”ï¸";
    document.getElementById("progressLabel").textContent = all
      ? "æœã®ãƒŸãƒƒã‚·ãƒ§ãƒ³å…¨ã‚¯ãƒªã‚¢ï¼ ã™ã”ã„ï¼"
      : "æœã®ãƒŸãƒƒã‚·ãƒ§ãƒ³ " + done + " / " + total;
    document.getElementById("progressFill").style.width = ((done / total) * 100) + "%";
  }

  function updateHeader() {
    var rank = getRank(totalXP);
    var next = getNextRank(totalXP);
    var pct  = next
      ? Math.round(((totalXP - rank.min) / (next.min - rank.min)) * 100)
      : 100;
    document.getElementById("rankName").textContent = rank.name;
    document.getElementById("rankName").style.color  = rank.color;
    document.getElementById("xpFill").style.width    = pct + "%";
    document.getElementById("xpFill").style.background = "linear-gradient(90deg," + rank.color + ",#fff)";
    document.getElementById("xpVal").textContent = totalXP;
  }

  function getRank(xp) {
    var rank = RANKS[0];
    RANKS.forEach(function(r) { if (xp >= r.min) rank = r; });
    return rank;
  }
  function getNextRank(xp) {
    for (var i = 0; i < RANKS.length; i++) {
      if (xp < RANKS[i].min) return RANKS[i];
    }
    return null;
  }

  function completeQuest(quest) {
    if (completed.indexOf(quest.id) !== -1) return;
    completed.push(quest.id);
    totalXP += quest.xp;
    showToast("+" + quest.xp + " XPï¼");
    fireConfetti();
    renderQuests();
    updateHeader();
  }

  function resetDay() {
    if (window.confirm("ä»Šæ—¥ã®ã‚¯ã‚¨ã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ")) {
      completed = [];
      renderQuests();
    }
  }

  // â”€â”€ ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ â”€â”€
  function switchTab(name) {
    ["board","hero","shop"].forEach(function(n) {
      document.getElementById("page-" + n).classList.toggle("hidden", n !== name);
      var btn = document.getElementById("tab-" + n);
      btn.classList.toggle("active", n === name);
    });
  }

  // â”€â”€ XPãƒˆãƒ¼ã‚¹ãƒˆ â”€â”€
  function showToast(msg) {
    var el = document.getElementById("xpToast");
    el.textContent = msg;
    el.classList.remove("hidden");
    setTimeout(function() { el.classList.add("hidden"); }, 1700);
  }

  // â”€â”€ ã‚³ãƒ³ãƒ•ã‚§ãƒƒãƒ†ã‚£ â”€â”€
  function fireConfetti() {
    var container = document.getElementById("confetti-container");
    container.innerHTML = "";
    for (var i = 0; i < 24; i++) {
      var dot = document.createElement("div");
      dot.style.cssText =
        "position:absolute;top:-20px;" +
        "left:" + ((i * 4.2) % 100) + "%;" +
        "width:10px;height:10px;border-radius:2px;" +
        "background:" + CONFETTI_COLORS[i % 6] + ";" +
        "animation:fall" + (i % 4) + " " + (0.9 + (i % 4) * 0.2) + "s ease-in forwards;" +
        "animation-delay:" + ((i % 5) * 0.1) + "s;" +
        "transform:rotate(" + (i * 15) + "deg);";
      container.appendChild(dot);
    }
    setTimeout(function() { container.innerHTML = ""; }, 2000);
  }
</script>
</body>
</html>
